{"version":3,"file":"actions.min.js","sources":["../src/actions.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Actions for webservice manager tool.\n *\n * @module     tool_wsmanager/actions\n * @copyright  Marina Glancy\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport ModalForm from 'core_form/modalform';\nimport {getString} from 'core/str';\nimport * as reportEvents from 'core_reportbuilder/local/events';\nimport * as reportSelectors from 'core_reportbuilder/local/selectors';\nimport {dispatchEvent} from 'core/event_dispatcher';\n\nconst SELECTORS = {\n    EDITSERVICES: '[data-action=\"tool_wsmanager-edit-services\"][data-function]',\n};\n\n/**\n * Initialize module.\n */\nexport function init() {\n\n    document.addEventListener('click', event => {\n\n        // Edit services for the function.\n        const editServices = event.target.closest(SELECTORS.EDITSERVICES);\n        if (editServices) {\n            event.preventDefault();\n            const functionname = editServices.dataset.function;\n\n            const modalForm = new ModalForm({\n                modalConfig: {\n                    title: getString('editservices', 'tool_wsmanager'),\n                },\n                formClass: 'tool_wsmanager\\\\form\\\\function_services_form',\n                args: {functionname},\n                saveButtonText: getString('savechanges', 'moodle'),\n                returnFocus: editServices,\n            });\n\n            // Show a toast notification when the form is submitted.\n            const reportElement = event.target.closest(reportSelectors.regions.report);\n            modalForm.addEventListener(modalForm.events.FORM_SUBMITTED, () => {\n                dispatchEvent(reportEvents.tableReload, {preservePagination: true}, reportElement);\n            });\n\n            modalForm.show();\n        }\n    });\n}"],"names":["document","addEventListener","event","editServices","target","closest","SELECTORS","preventDefault","functionname","dataset","function","modalForm","ModalForm","modalConfig","title","formClass","args","saveButtonText","returnFocus","reportElement","reportSelectors","regions","report","events","FORM_SUBMITTED","reportEvents","tableReload","preservePagination","show"],"mappings":";;;;;;;6gCAsCIA,SAASC,iBAAiB,SAASC,cAGzBC,aAAeD,MAAME,OAAOC,QAAQC,2BACtCH,aAAc,CACdD,MAAMK,uBACAC,aAAeL,aAAaM,QAAQC,SAEpCC,UAAY,IAAIC,mBAAU,CAC5BC,YAAa,CACTC,OAAO,kBAAU,eAAgB,mBAErCC,UAAW,+CACXC,KAAM,CAACR,aAAAA,cACPS,gBAAgB,kBAAU,cAAe,UACzCC,YAAaf,eAIXgB,cAAgBjB,MAAME,OAAOC,QAAQe,gBAAgBC,QAAQC,QACnEX,UAAUV,iBAAiBU,UAAUY,OAAOC,gBAAgB,yCAC1CC,aAAaC,YAAa,CAACC,oBAAoB,GAAOR,kBAGxER,UAAUiB,4LAjChBtB,uBACY"}